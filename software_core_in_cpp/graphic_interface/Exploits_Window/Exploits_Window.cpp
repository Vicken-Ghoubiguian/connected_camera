#include "Exploits_Window.hpp"

Exploits_Window::Exploits_Window()
{
	set_title("Connected camera");
	set_border_width(10);

	color_codes_map = color_codes_map_initialisation_function();

	webcam_frame.set_label("Current mode: ordinary mode");
	webcam_frame.set_label_align(Gtk::ALIGN_CENTER, Gtk::ALIGN_CENTER);
	webcam_frame.set_shadow_type(Gtk::SHADOW_OUT);
	webcam_frame.set_size_request(640, 457);

	webcam_area.set_tooltip_text("Camera");
    	webcam_frame.add(webcam_area);

	widgets_grid.attach(webcam_frame, 0, 0, 1, 1);

	description_label.set_text(print_howto_in_window());

	//******************* Indication labels ***************************************************

	indication_label_for_modes.set_text("Shortly, modes management will be there");
	indication_label_for_body_parts_detection.set_text("Shortly, body parts detection management will be there");
	indication_label_for_multimedia_features.set_text("Shortly, multimedia features management will be there");

	//*****************************************************************************************

	management_notebook.append_page(indication_label_for_modes, "Modes");
	management_notebook.append_page(indication_label_for_body_parts_detection, "Body parts detection");
	management_notebook.append_page(indication_label_for_multimedia_features, "Multimedia features");
	management_notebook.append_page(description_label, "Shortcut keys");

	widgets_grid.attach(management_notebook, 0, 1, 1, 1);

	add(widgets_grid);

	add_events(Gdk::KEY_PRESS_MASK);

	showing_exploits_window_function();

	set_icon_from_file("../repository_common_files/images/connected_camera_icons/3.png");
}

bool Exploits_Window::on_key_press_event(GdkEventKey* key_event)
{
	time_now_as_string = today_as_string_returning_function();

	if(key_event->keyval == GDK_KEY_Escape)
	{
		hide();

		return true;
	}
	else if(key_event->keyval == GDK_KEY_a)
	{
		webcam_area.setCurrent_mode(CC_BLACK_AND_WHITE_WITH_RGB_MODE);

		writting_in_console_function(color_codes_map["BackgroundGreen"], "[" + time_now_as_string + "]: Activation of black and white with RGB application mode");

		set_text_label_for_webcam_frame("Current mode: black and white with RGB mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_y)
	{
		webcam_area.setCurrent_mode(CC_EDGE_DETECTION_MODE);

		writting_in_console_function(color_codes_map["BackgroundGreen"], "[" + time_now_as_string + "]: Activation of edge detection mode");

		set_text_label_for_webcam_frame("Current mode: edge detection mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_p)
	{
		webcam_area.setCurrent_mode(CC_DRAW_MODE);

		writting_in_console_function(color_codes_map["BackgroundGreen"], "[" + time_now_as_string + "]: Activation of printed mode");

		set_text_label_for_webcam_frame("Current mode: draw mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_h)
	{
		webcam_area.setCurrent_mode(CC_HUE_SATURATION_LIGHTNESS_MODE);

		writting_in_console_function(color_codes_map["BackgroundCyan"], "[" + time_now_as_string + "]: Activation of hue saturation lightness mode");

		set_text_label_for_webcam_frame("Current mode: hue saturation lightness mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_i)
	{
		webcam_area.setCurrent_mode(CC_NEGATIVE_OR_INVERTED_MODE);

		writting_in_console_function(color_codes_map["BackgroundRed"], "[" + time_now_as_string + "]: Activation of negative or inverted mode");

		set_text_label_for_webcam_frame("Current mode: negative or inverted mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_g)
	{
		webcam_area.setCurrent_mode(CC_BLACK_AND_WHITE_WITH_GRAY_MODE);

		writting_in_console_function(color_codes_map["BackgroundGreen"], "[" + time_now_as_string + "]: Activation of black and white with gray application mode");

		set_text_label_for_webcam_frame("Current moCC_BLACK_AND_WHITE_WITH_GRAY_MODEde: gray and white mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_w)
	{
		webcam_area.setCurrent_mode(CC_GRAY_AND_WHITE_MODE);

		writting_in_console_function(color_codes_map["BackgroundCyan"], "[" + time_now_as_string + "]: Activation of gray and white mode");

		set_text_label_for_webcam_frame("Current mode: gray and white mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_c)
	{
		webcam_area.setCurrent_mode(CC_PAINTING_MODE);

		writting_in_console_function(color_codes_map["BackgroundGreen"], "[" + time_now_as_string + "]: Activation of cartoonized mode");

		set_text_label_for_webcam_frame("Current mode: painting mode");

		return true;
	}
	else if(key_event->keyval == GDK_KEY_o)
	{
		webcam_area.setCurrent_mode(CC_ORDINARY_MODE);

		writting_in_console_function(color_codes_map["BackgroundGreen"], "[" + time_now_as_string + "]: Activation of ordinary mode");

		set_text_label_for_webcam_frame("Current mode: ordinary mode");

		return true;
	}

	return Gtk::Window::on_key_press_event(key_event);
}

void Exploits_Window::showing_exploits_window_function()
{
	show_all();
}

Exploits_Window::~Exploits_Window()
{

}

void Exploits_Window::set_text_label_for_webcam_frame(string new_text_label_for_webcam_frame)
{
	ustring new_ready_text_label(new_text_label_for_webcam_frame);

	webcam_frame.set_label(new_ready_text_label);
}
